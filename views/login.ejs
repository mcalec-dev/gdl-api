<!doctype html>
<html lang="en">
  <%- include('partials/head') %>
  <body class="relative flex min-h-screen items-center justify-center bg-black">
    <%- include('partials/navbar') %> 
    <%- include('partials/settings') %>
    <div id="container" class="z-10 mx-auto mb-[6vh] mt-[12vh] w-full rounded-xl border border-white/20 p-4 shadow-lg backdrop-blur-md sm:p-8 md:w-auto md:min-w-[25%] md:max-w-[65%]">
      <h1 id="title" class="mb-8 text-center text-3xl font-light capitalize text-white">
        <%= currentPage %>
      </h1>
      <div id="error" class="error-message mb-4 text-center text-red-500" hidden></div>
      <form id="loginForm" class="space-y-3">
        <div>
          <label for="username" class="mb-1 block text-gray-300">
            Username or Email
          </label>
          <input type="text" id="username" name="username" required autocomplete="username" placeholder="Enter your username or email" class="w-full rounded border border-white/20 bg-[#1f1f1f] px-4 py-2 text-white" />
        </div>
        <div>
          <label for="password" class="mb-1 block text-gray-300">
            Password
          </label>
          <input type="password" id="password" name="password" required autocomplete="current-password" placeholder="Enter your password" class="w-full rounded border border-white/20 bg-[#1f1f1f] px-4 py-2 text-white" />
        </div>
        <div>
          <script defer src="https://challenges.cloudflare.com/turnstile/v0/api.js" crossorigin="anonymous"></script>
          <div id="cf-turnstile" class="cf-turnstile w-full" data-sitekey="0x4AAAAAAAXoeQTEYHCuF4f1" data-theme="auto" data-size="flexible" data-callback="onTurnstileSuccess" data-error-callback="onTurnstileError" data-expired-callback="onTurnstileExpired"></div>
          <button id="submit-btn" type="submit" class="w-full rounded bg-blue-600 py-2 font-medium text-white" hidden>
            Login
          </button>
          <script type="text/javascript">
            function onTurnstileSuccess(token) {document.getElementById('submit-btn').hidden = false;document.getElementById('cf-turnstile').hidden = true}
            function onTurnstileError(errorCode) {console.error('Turnstile error:', errorCode);document.getElementById('submit-btn').hidden = true}
            function onTurnstileExpired() {console.warn('Turnstile token expired');document.getElementById('submit-btn').hidden = true}
          </script>
        </div>
      </form>
      <div id="loading" class="mt-4 text-center text-gray-300" hidden>
        Logging in...
      </div>
      <div class="flex items-center justify-center py-5">
        <span class="text-sm text-gray-400">
          or
        </span>
      </div>
      <div class="flex flex-col w-full items-center justify-center gap-2 md:flex-row">
        <a href="/api/auth/discord" class="flex w-fit items-center justify-center gap-2 rounded bg-[#5662f6] px-3 py-2 font-medium text-white">
          <img src="/svg/discord.svg" alt="Discord" class="invert h-5 w-5" />
          Login with Discord
        </a>
        <a href="/api/auth/github" class="flex w-fit items-center justify-center gap-2 rounded bg-[#212830] px-3 py-2 font-medium text-white">
          <img src="/svg/github.svg" alt="GitHub" class="h-5 w-5" />
          Login with GitHub
        </a>
      </div>
      <div class="mt-5 text-center">
        <p class="text-white">
          Don't have an account?
          <br />
          <a href="/register/" class="text-blue-500">
            Register here
          </a>
        </p>
      </div>
    </div>
    <script type="module" src="/js/min/login.min.js"></script>
    <%- include('partials/bg') %>
  </body>
</html>
